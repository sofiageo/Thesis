\chapter{Υλοποιήσεις}
\section{Ιστορία}
Παραδοσιακά, η σειρά αγωγών των γραφικών, αποτελείται από τις καταστάσεις μετατροπή και φωτισμός, συναρμολόγηση αρχέγονων, μετατροπή σε pixels, και σκίαση. Οι πρώτες GPU είχαν όλες τις λειτουργίες που χρειάζονται για να εκτελεστεί η σειρά αγωγών, αλλά με τον καιρό όλο και περισσότερες καταστάσεις έγιναν δυνατό να προγραμματιστούν με την έλευση ειδικών επεξεργαστών, όπως επεξεργαστές κορυφών και τεμάχια επεξεργαστών, που κατέστησαν κάποιες λειτουργίες πιο ευέλικτες.\\
Όταν οι τιμές συνέχισαν να πέφτουν ενώ η υπολογιστική δύναμη αυξανόταν, η ερευνητική κοινότητα σκέφτηκε τρόπους να αξιοποιηθεί αυτή η δύναμη για τον υπολογισμό δύσκολων λειτουργιών. Όμως, καθώς η δυνατότητα των επεξεργαστών ήταν περιορισμένη και η διεπαφή προγραμματιστικής διεπαφής (API) των οδηγών γραφικών ήταν σχεδιασμένη για να υλοποιεί συγκεκριμένα την σειρά αγωγών, έπρεπε να ληφθούν υπόψιν πολλές παράμετροι. Για παράδειγμα, όλα τα δεδομένα έπρεπε να κωδικοποιηθούν σε υφές ως πίνακες δυο διαστάσεων που αναπαριστούν pixel, με περιεχόμενο τιμές χρωμάτων και κάποιο κανάλι alpha για την διαφάνεια. Επιπλέον, οι υφές είναι αντικείμενα μόνο προσπελάσιμα, και δεν επαναγράφονταν, κάτι που ανάγκαζε τους προγραμματιστές να αποθηκεύουν κάθε φορά καινούρια υφή με τις αλλαγές. Τέλος, οι περισσότερες GPU υποστήριζαν μόνο λειτουργίες μονής κινητής υποδιαστολής, αναγκάζοντας τους προγραμματιστές να προσομοιώνουν λογικές λειτουργίες.\\
Αυτοί οι περιορισμοί, ήταν ο μεγαλύτερος λόγος που ώθησε τους κατασκευαστές GPU (AMD,NVIDIA,INTEL), να δημιουργήσουν προγραμματιστικές διεπαφές ειδικές για την κοινότητα του GPGPU και να εξελίξουν τις συσκευές τους για καλύτερη υποστήριξη.

Το πεδίο του προγραμματισμού γενικής χρήσης έχει αναπτυχθεί με ταχύτατους ρυθμούς τα τελευταία χρόνια, έτσι ώστε τώρα υπάρχουν αρκετές υλοποιήσεις για τον προγραμματισμό των μονάδων επεξεργασίας γραφικών. Πρόσφατα, έχουν γίνει προσπάθειες δημιουργίας προτύπων.
Ο προγραμματισμός των GPUs αναπτύχθηκε όταν το CUDA και το Stream κατέφθασαν στο τέλος του 2006. Αυτές οι διεπαφές και οι γλώσσες, σχεδιάστηκαν από τις εταιρίες κατασκευής των GPUs σε πολύ κοντινή σχέση με το υλικό, το οποίο αποτέλεσε μεγάλο βήμα προς ένα πιο εύχρηστο, ταιριαστό και μελλοντικά-ασφαλές προγραμματιστικό μοντέλο. Η ανοιχτή γλώσσα προγραμματισμού (OpenCL) δημιουργήθηκε για να παρέχει ένα γενικό API ετερογενή υπολογισμού σε διάφορες μορφές παράλληλων συσκευών, συμπεριλαμβανομένου μονάδων επεξεργασίας γραφικών, πολυπύρηνων κεντρικών μονάδων επεξεργασίας, κ.α

\section{CUDA}
\subsection{Εισαγωγή}
To CUDA είναι μια πλατφόρμα παράλληλου υπολογισμού, που δημιουργήθηκε από την NVIDIA και υλοποιήθηκε στις κάρτες γραφικών τις οποίες παράγει η ίδια. Το CUDA δίνει στους προγραμματιστές άμεση πρόσβαση στο σετ εικονικών εντολών και την μνήμη των στοιχείων του παράλληλου υπολογισμού σε κάρτες γραφικών NVIDIA. \\
\\
Αξιοποιώντας το CUDA, οι κάρτες γραφικών(GPU) μπορούν να χρησιμοποιηθούν για υπολογισμό γενικής χρήσης (δηλαδή όχι αποκλειστικά για γραφικά).Οι GPU έχουν μια αρχιτεκτονική παράλληλης εξόδου η οποία δίνει έμφαση στην εκτέλεση πολλών threads με μικρή ταχύτητα, σε αντίθεση με τις CPU όπου εκτελείται ένα thread με μεγάλη ταχύτητα. \\
\\
\begin{figure}[h]
\centering
\includegraphics[scale=0.50]{nvidia-cuda}
\caption{Βιολογία και πληροφορική}
\end{figure}
\\
Η πλατφόρμα CUDA είναι προσβάσιμη στους προγραμματιστές μέσω βιβλιοθηκών, εντολών μεταγλώττισης, και προεκτάσεων σε γλώσσες προγραμματισμού βιομηχανικής κλίμακας, όπως η C, C++ και Fortran. Οι προγραμματιστές της C/C++, χρησιμοποιούν το CUDA C/C++, μεταγλωττισμένο με το nvcc, έναν LLVM βασισμένο μεταγλωττιστή, και οι προγραμματιστές της Fortran χρησιμοποιούν το CUDA Fortran, μεταγλωττισμένο με τον μεταγλωττιστή PGI CUDA Fortran απο το The Portland Group. Εκτώς απο τα παραπάνω, η πλατφόρμα CUDA υποστηρίζει και άλλες διεπαφές υπολογισμού, όπως το OpenCL του Khronos Group, το DirectCompute της Microsoft, και το C++ AMP.\\
Στην βιομηχανία των υπολογιστών, οι GPUs δεν χρησιμοποιούνται μόνο για τα γραφικά αλλά και στους υπολογισμούς φυσικής παιχνιδιών (π.χ καπνός, φωτιά, ροή υγρών). Γνωστά παραδείγματα αποτελούν οι μηχανές PhysX και η Bullet. Το CUDA επίσης χρησιμοποιείται για να επιταχύνει μη-γραφικές εφαρμογές στην βιοπληροφορική, στην κρυπτογραφία, και σε πολλά άλλα πεδία.\\

Γενικότερα, η υπολογιστική δύναμη της GPU, βασίζεται στην παράλληλη αρχιτεκτονική της. Για αυτό, η πλατφόρμα του CUDA παρουσιάζει το νήμα(thread) ως το μικρότερο στοιχείο παραλληλισμού. Όμως, σε σύγκριση με την κεντρική μονάδα επεξεργασίας, τα νήματα της GPU έχουν μικρότερο κόστος χρήσης πόρων και μικρότερο κόστος δημιουργίας και αντικατάστασης. Σημειώνεται ότι οι GPU είναι αποτελεσματικές, μόνο όταν τρέχει μεγάλος αριθμός απο τέτοια νήματα. Μια ομάδα από νήματα, που εκτελούνται παράλληλα, επικοινωνούν και συγχρονίζονται μεταξύ τους ονομάζεται block. Ο μέγιστος αριθμός των νημάτων σε ενα block είναι ένας περιορισμός που υπάρχει στην κάθε μονάδα γραφικής επεξεργασίας. Τέλος, μια ομάδα από blocks τα οποία έχουν την ίδια διάσταση και εκτελούνται απο το ίδιο πρόγραμμα CUDA παράλληλα, ονομάζεται πλέγμα.\\
Για να επιτρέψει βέλτιστη επίδοση για διαφορετικά πρότυπα, το CUDA εκτελεί ένα ιεραρχικό μοντέλο μνήμης, αντίθετα με τα παραδοσιακά μοντέλα που συναντάμε συνήθως στους υπολογιστές. Ο υπολογιστής και η συσκευή, έχουν τις δικές τους περιοχές μνήμης, τις οποίες ονομάζουν host memory και device memory, αντίστοιχα. Το CUDA παρέχει βελτιστοποιημένες λειτουργίες για να μεταφέρει δεδομένα από και προς αυτούς τους ξεχωριστούς χώρους.
Κάθε νήμα κατέχει το δικό του αρχείο καταχώρησης, το οποίο μπορεί να προσπελαστεί και να εγγραφεί. Επιπλέον, μπορεί να προσπελάσει το δικό του αντίγραφο της τοπικής μνήμης. Όλα τα νήματα στο ίδιο πλέγμα μπορούν να προσπελάσουν και να γράψουν στην περιοχή της κοινόχρηστης μνήμης (shared memory). Για να αποφευχθούν κίνδυνοι από ταυτόχρονη προσπέλαση, μηχανισμοί συγχρονισμού νημάτων πρέπει να χρησιμοποιηθούν. Η κοινόχρηστη μνήμη, είναι οργανωμένη σε ομάδες που ονομάζονται τράπεζες, οι οποίες μπορούν να προσπελαστούν παράλληλα. Όλα τα νήματα έχουν επίσης πρόσβαση στον χώρο μνήμης που ονομάζεται καθολική μνήμη (global memory) και στις περιοχές που ονομάζονται μνήμη σταθερών (constant memory) και μνήμη υφής (texture memory).

\subsection{Πλεονεκτήματα}
Το CUDA έχει τα εξής πλεονεκτήματα σε σχέση με τους παραδοσιακούς τρόπους υπολογισμού γενικής χρήσης που εκτελούνται μέσω προγραμματιστικών διεπαφών γραφικών:
 Διασκορπισμένες προσπελάσεις - ο κώδικας μπορεί να διαβαστεί από αυθαίρετες διευθύνσεις στην μνήμη.
 Ενοποιημένη εικονική μνήμη (CUDA 6)
 Κοινόχρηστη μνήμη - το CUDA εκθέτει μια γρήγορη περιοχή κοινόχρηστης μνήμης (μέχρι 48KB για κάθε επεξεργαστή) η οποία μπορεί να μοιραστεί ανάμεσα στα threads. Αυτή μπορεί να χρησιμοποιηθεί σαν κρυφή μνήμη διαχειρίσιμη απο τον χρήστη, επιτρέποντας μεγαλύτερο εύρος δεδομένων απο ότι είναι δυνατό με τις προσπελάσεις υφών.
 Πιο γρήγορες μεταφορτώσεις και προσπελάσεις από και προς την GPU
 Πλήρης υποστήριξη για ακέραιες και bitwise λειτουργίες, για παράδειγμα τις προσπελάσεις υφών.
\subsection{Περιορισμοί}
 Το CUDA δεν υποστηρίζει ολόκληρο το πρότυπο της γλώσσας C, καθώς τρέχει μέσω ενός μεταγλωττιστή C++, ο οποίος εμποδίζει συγκεκριμένα μέρη της γλώσσας C να μεταγλωττιστούν.
 
\begin{table}
\begin{tabular}{ | c | c |}
Feature support (unlisted features are\\ supported for all compute capabilities) & Compute capability (version)\\ \hline
\end{tabular}
\end{table}

\pagebreak
\section{OpenCL}
\subsection{Εισαγωγή}
Το OpenCL είναι ένα πλαίσιο για κατασκευή εφαρμογών που εκτελούνται σε ετερογενή συστήματα που αποτελούνται από κεντρικές μονάδες επεξεργασίας(CPU), μονάδες επεξεργασίας γραφικών(GPU), επεξεργαστές ψηφιακών σημάτων(DPS), συστοιχίες προγραμματιζόμενων θυρίδων(FPGA), και άλλους επεξεργαστές. Το OpenCL περιέχει μια γλώσσα, υποσύνολο του ISO C99 με επεκτάσεις, για τον προγραμματισμό αυτών των συσκευών, προγραμματιστικές διεπαφές εφαρμογών(API) για τον έλεγχο της πλατφόρμας και την εκτέλεση προγραμμάτων στις υπολογιστικές συσκευές. Το OpenCL παρέχει παράλληλο υπολογισμό χρησιμοποιώντας παραλληλισμό διεργασιών και δεδομένων.\\
Αποτελεί το πρώτο ανοιχτό, ελεύθερο από τέλη αδειών πρότυπο για cross-platform, παράλληλο προγραμματισμό μοντέρνων επεξεργαστών, που χρησιμοποιούνται συνήθως σε προσωπικούς υπολογιστές, διακομιστές, και φορητές/ενσωματωμένες συσκευές. Το OpenCL (Open Computing Language) βελτιώνει αισθητά την ταχύτητα και την απόκριση μεγάλου εύρους εφαρμογών σε διάφορες κατηγορίες αγορών από παιχνίδια και ψυχαγωγία, μέχρι επιστημονικές εφαρμογές και εφαρμογές υγείας. Συντηρείται απο το μή-κερδοσκοπικό τεχνολογικό συνεταιρισμό \href{http://www.khronos.org}{Khronos Group}. Έχει υιοθετηθεί από πολλές μεγάλες εταιρίες όπως η Apple, Intel, Qualcomm, AMD, Nvidia,Samsung,ARM Holdings.
\begin{figure}[h]
	\includegraphics[scale=0.75]{opencl_logo}
	\centering
	\caption{Λογότυπο OpenCL}
\end{figure}
\subsection{Επισκόπηση}
Το OpenCL ορίζει μια διεπαφή προγραμματισμού εφαρμογών με την οποία επιτρέπει στα προγράμματα που τρέχουν στον οικοδεσπότη να εκτελέσουν πυρήνες στην συσκευή υπολογισμού, και να διαχειριστούν την μνήμη της συσκευής, που είναι ξεχωριστή από την μνήμη του οικοδεσπότη. Τα προγράμματα του OpenCL είναι σχεδιασμένα ώστε να μεταγλωττίζονται την ώρα της εκτέλεσης, και με αυτόν τον τρόπο γίνεται δυνατό να εκτελεστούν σε διάφορες συσκευές. Το πρότυπο του OpenCL ορίζει διεπαφές προγραμματισμού για γλώσσα C και C++. Διεπαφές επίσης υπάρχουν και για άλλες γλώσσες, όπως Python, Julia, και Java. Μια εφαρμογή του OpenCL προτύπου συνίσταται απο μια βιβλιοθήκη που υλοποιεί την διεπαφή για C και C++, και έναν μεταγλωττιστή OpenCL για τις συσκευές υπολογισμού.\\
\subsubsection{Ιεραρχία μνήμης}
Το OpenCL ορίζει ιεραρχία τεσσάρων επιπέδων για την μνήμη των συσκευών υπολογισμού:
\begin{itemize}
\item Καθολική μνήμη: διαμοιράζεται σε όλες τις συσκευές υπολογισμού, αλλά έχει μεγάλη καθυστέρηση απόκρισης
\item Μνήμη προσπέλασης: μικρότερη, χαμηλή καθυστέρηση απόκρισης, εγγράψιμη από την κεντρική μονάδα επεξεργασίας του οικοδεσπότη, αλλά όχι των συσκευών υπολογισμού.
\item Τοπική μνήμη: διαμοιράζεται σε πολλά στοιχεία υπολογισμού μιας συσκευής
\item Ιδιωτική μνήμη στοιχείου (καταχωρητές) 
\end{itemize}   
Δεν είναι απαραίτητο για όλες τις συσκευές να υλοποιήσουν την ιεραρχία της μνήμης στο υλικό. Η συνέπεια στα διάφορα επίπεδα της ιεραρχίας είναι χαλαρή, και επιβάλλεται μόνο από κατηγορηματικά στοιχεία συγχρονισμού, όπως τα εμπόδια.
\subsection{Ιστορία}
Το OpenCL δημιουργήθηκε αρχικά απο την Apple Inc., η οποία κατέχει τα πνευματικά δικαιώματα, και εξευγενίστηκε σε αρχική πρόταση σε συνεργασία με τεχνικές ομάδες της AMD,IBM,Qualcomm,Intel, και Nvidia. Η Apple καταχώρησε την πρόταση στο Khronos Group, και τον Ιούνιο του 2008 διαμορφώθηκε το Khronos Compute Working Group με αντιπρόσωπους από εταιρίες επεξεργαστών, μονάδων υλικού γραφικών, ενσωματωμένων-επεξεργαστών, και λογισμικού. Αυτό το group εργάστηκε για 5 μήνες ώστε να φέρει σε πέρας τον πρώτο προσδιορισμό για το OpenCL 1.0, ο οποίος κυκλοφόρησε τον Δεκέμβριο του 2008. 
\subsubsection{OpenCL 1.0} Η AMD, αν και αρχικά εργαζόταν πάνω στο πρότυπο Close to Metal, αποφάσισε να στραφεί και να υποστηρίξει το OpenCL. Η Nvidia ανακοίνωσε πλήρης υποστήριξη στην εργαλειοθήκη υπολογισμού GPU. Το 2009, η IBM κυκλοφόρησε την πρώτη έκδοση του μεταγλωττιστή της με υποστήριξη για OpenCL
\subsubsection{OpenCL 1.1} Το OpenCL 1.1 επικυρώθηκε από το Khronos Group τον Ιούνιο του 2010, και προσθέτει σημαντικές λειτουργίες για βελτιωμένη ευελιξία παράλληλου προγραμματισμού, λειτουργικότητα, και επιδόσεις.
\subsubsection{OpenCL 1.2} Το OpenCL 1.2 ανακοινώθηκε τον Νοέμβριο του 2011 απο το Khronos Group, το οποίο προσθέτει αρκετές λειτουργίες σε σχέση με τις προηγούμενες εκδόσεις όσον αφορά τις επιδόσεις και χαρακτηριστικά για παράλληλο προγραμματισμό.
\subsubsection{OpenCL 2.0} Το OpenCL 2.0 επικυρώθηκε και κυκλοφόρησε τον Νοέμβριο του 2013 απο το Khronos Group και αποτελεί την τελευταία έκδοση του OpenCL.