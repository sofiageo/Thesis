\section{OpenCL}
\subsection{Εισαγωγή}
Το πρώτο GPGPU framework δημιουργήθηκε απο την NVIDIA και ήταν το CUDA. Το CUDA παρείχε στους χρήστες ένα προγραμματιστικό περιβάλλον σε C like γλώσσα για την GPU. Όμως ήταν κλειστού κώδικα και μπορεί να τρέχει μόνο σε NVIDIA κάρτες γραφικών. Λόγω της μεγάλης δημοτικότητας του CUDA, η ανάγκη για ένα ανοιχτό πρότυπο αρχιτεκτονικής που θα υποστηρίζει διάφορα είδη συσκευών απο διάφορους κατασκευαστές γινόταν όλο και πιο σημαντική. Έτσι τον Ιούνιο του 2008 το Khronos Group δημιούργησε το OpenCL 1.0. Αρκετοί κατασκευαστές σταδιακά παρείχαν εργαλεία για προγραμματισμό σε OpenCL συμπεριλαμβανομένων των: Nvidia OpenCL Drivers and Tools, AMD APP SDK,Intel SDK for OpenCL applications,IBM Server with OpenCL development Kit, κ.α. Σήμερα το OpenCL επιτρέπει πολυπύρηνο προγραμματισμό, προγραμματισμό GPU, κ.α \cite{opencl-1}   


\begin{figure}[h]
	\includegraphics[width=0.5\linewidth]{opencl_logo}
	\centering
	\caption{Λογότυπο OpenCL}
\end{figure}

Το OpenCL είναι ένα πλαίσιο για κατασκευή εφαρμογών που εκτελούνται σε ετερογενή συστήματα που αποτελούνται από κεντρικές μονάδες επεξεργασίας(CPU), μονάδες επεξεργασίας γραφικών(GPU), επεξεργαστές ψηφιακών σημάτων(DPS), συστοιχίες προγραμματιζόμενων θυρίδων(FPGA), και άλλους επεξεργαστές. Το OpenCL περιέχει μια γλώσσα, υποσύνολο του ISO C99 με επεκτάσεις, για τον προγραμματισμό αυτών των συσκευών, προγραμματιστικές διεπαφές εφαρμογών(API) για τον έλεγχο της πλατφόρμας και την εκτέλεση προγραμμάτων στις υπολογιστικές συσκευές. Το OpenCL παρέχει παράλληλο υπολογισμό χρησιμοποιώντας παραλληλισμό διεργασιών και δεδομένων.\\
Αποτελεί το πρώτο ανοιχτό, ελεύθερο από τέλη αδειών πρότυπο για cross-platform, παράλληλο προγραμματισμό μοντέρνων επεξεργαστών, που χρησιμοποιούνται συνήθως σε προσωπικούς υπολογιστές, διακομιστές, και φορητές/ενσωματωμένες συσκευές. Το OpenCL (Open Computing Language) βελτιώνει αισθητά την ταχύτητα και την απόκριση μεγάλου εύρους εφαρμογών σε διάφορες κατηγορίες αγορών από παιχνίδια και ψυχαγωγία, μέχρι επιστημονικές εφαρμογές και εφαρμογές υγείας. Συντηρείται απο το μή-κερδοσκοπικό τεχνολογικό συνεταιρισμό Khronos Group. Έχει υιοθετηθεί από πολλές μεγάλες εταιρίες όπως η Apple, Intel, Qualcomm, AMD, Nvidia,Samsung,ARM Holdings.

\subsection{Επισκόπηση}
Το OpenCL ορίζει μια διεπαφή προγραμματισμού εφαρμογών με την οποία επιτρέπει στα προγράμματα που τρέχουν στον οικοδεσπότη να εκτελέσουν πυρήνες στην συσκευή υπολογισμού, και να διαχειριστούν την μνήμη της συσκευής, που είναι ξεχωριστή από την μνήμη του οικοδεσπότη. Τα προγράμματα του OpenCL είναι σχεδιασμένα ώστε να μεταγλωττίζονται την ώρα της εκτέλεσης, και με αυτόν τον τρόπο γίνεται δυνατό να εκτελεστούν σε διάφορες συσκευές. Το πρότυπο του OpenCL ορίζει διεπαφές προγραμματισμού για γλώσσα C και C++. Διεπαφές επίσης υπάρχουν και για άλλες γλώσσες, όπως Python, Julia, και Java.\cite{opencl-2} Μια εφαρμογή του OpenCL προτύπου αποτελείται απο μια βιβλιοθήκη που υλοποιεί την διεπαφή για C και C++, και έναν μεταγλωττιστή OpenCL για τις συσκευές υπολογισμού.\\
\subsubsection{Ιεραρχία μνήμης}
Το OpenCL ορίζει ιεραρχία τεσσάρων επιπέδων για την μνήμη των συσκευών υπολογισμού:
\begin{itemize}
\item Καθολική μνήμη: διαμοιράζεται σε όλες τις συσκευές υπολογισμού, αλλά έχει μεγάλη καθυστέρηση απόκρισης
\item Μνήμη προσπέλασης: μικρότερη, χαμηλή καθυστέρηση απόκρισης, εγγράψιμη από την κεντρική μονάδα επεξεργασίας του οικοδεσπότη, αλλά όχι των συσκευών υπολογισμού.
\item Τοπική μνήμη: διαμοιράζεται σε πολλά στοιχεία υπολογισμού μιας συσκευής
\item Ιδιωτική μνήμη στοιχείου (καταχωρητές) 
\end{itemize}   
Δεν είναι απαραίτητο για όλες τις συσκευές να υλοποιήσουν την ιεραρχία της μνήμης στο υλικό. Η συνέπεια στα διάφορα επίπεδα της ιεραρχίας είναι χαλαρή, και επιβάλλεται μόνο από κατηγορηματικά στοιχεία συγχρονισμού, όπως τα εμπόδια.
\subsection{Ιστορία}
Το OpenCL δημιουργήθηκε αρχικά απο την Apple Inc., η οποία κατέχει τα πνευματικά δικαιώματα, και εξευγενίστηκε σε αρχική πρόταση σε συνεργασία με τεχνικές ομάδες της AMD,IBM,Qualcomm,Intel, και Nvidia. Η Apple καταχώρησε την πρόταση στο Khronos Group, και τον Ιούνιο του 2008 διαμορφώθηκε το Khronos Compute Working Group με αντιπρόσωπους από εταιρίες επεξεργαστών, μονάδων υλικού γραφικών, ενσωματωμένων-επεξεργαστών, και λογισμικού. Αυτό το group εργάστηκε για 5 μήνες ώστε να φέρει σε πέρας τον πρώτο προσδιορισμό για το OpenCL 1.0, ο οποίος κυκλοφόρησε τον Δεκέμβριο του 2008. 
\begin{table}[h]
	\begin{tabular}{|l|p{.9\linewidth}|}
	\hline
OpenCL 1.0 & Η AMD, αν και αρχικά εργαζόταν πάνω στο πρότυπο Close to Metal, αποφάσισε να στραφεί και να υποστηρίξει το OpenCL. Η Nvidia ανακοίνωσε πλήρης υποστήριξη στην εργαλειοθήκη υπολογισμού GPU. Το 2009, η IBM κυκλοφόρησε την πρώτη έκδοση του μεταγλωττιστή της με υποστήριξη για OpenCL\\ \hline
OpenCL 1.1 & Το OpenCL 1.1 επικυρώθηκε από το Khronos Group τον Ιούνιο του 2010, και προσθέτει σημαντικές λειτουργίες για βελτιωμένη ευελιξία παράλληλου προγραμματισμού, λειτουργικότητα, και επιδόσεις.\\ \hline
OpenCL 1.2 & Το OpenCL 1.2 ανακοινώθηκε τον Νοέμβριο του 2011 απο το Khronos Group, το οποίο προσθέτει αρκετές λειτουργίες σε σχέση με τις προηγούμενες εκδόσεις όσον αφορά τις επιδόσεις και χαρακτηριστικά για παράλληλο προγραμματισμό.\\ \hline
OpenCL 2.0 & Το OpenCL 2.0 επικυρώθηκε και κυκλοφόρησε τον Νοέμβριο του 2013 απο το Khronos Group και αποτελεί την τελευταία έκδοση του OpenCL. \\ \hline
	\end{tabular}
\end{table}

\subsection{Στόχοι}
Ο στόχος του OpenCL είναι να κάνει ορισμένους τύπους παράλληλου προγραμματισμού πιο εύκολους, και να παρέχει ανεξαρτήτου κατασκευαστή παράλληλη εκτέλεση κώδικα μέσω επιτάχυνσης υλικού. Το OpenCL είναι το πρώτο ανοιχτό, ελεύθερο πρότυπο για παράλληλο προγραμματισμό γενικού σκοπού ετερογενών συστημάτων. Παρέχει ένα προγραμματιστικό περιβάλλον που βοηθάει τους προγραμματιστές να γράψουν αποδοτικό, φορητό κώδικα για συστήματα υψηλής απόδοσης, προσωπικούς υπολογιστές, και κινητές συσκευές χρησιμοποιώντας ένα μείγμα πολυπύρηνων CPUs,GPUs, και DSPs.\\
Το OpenCL παρέχει στους προγραμματιστές ένα κοινό σετ εργαλείων εύκολης χρήσης\cite{opencl-3}, ώστε αυτοί να εκμεταλλευτούν οποιαδήποτε συσκευή που περιέχει οδηγό OpenCL για την εκτέλεση παράλληλου κώδικα. Το OpenCL framework ορίζει μια γλώσσα C like για την δημιουργία των πυρήνων, και ένα σετ απο APIs για την δημιουργία και την διαχείριση αυτών των πυρήνων. Οι πυρήνες είναι διαδικασίες οι οποίες μπορούν να εκτελούνται σε διαφορετικές συσκευές. Οι πυρήνες μεταγλωττίζονται απο έναν μεταγλωτιστή runtime, μέσω κατάλληλου προγράμματος. Αυτό επιτρέπει στα προγράμματα να εκμεταλλεύονται όλες τις συσκευές ενός συστήματος με ένα σετ φορητών υπολογιστικών πυρήνων.
\subsection{Μοντέλο εκτέλεσης}
Τα κύρια μέρη εκτέλεσης ενός προγράμματος OpenCL είναι ο πυρήνας και το πρόγραμμα ξενιστή. Οι πυρήνες εκτελούνται στην συσκευή OpenCL και το πρόγραμμα ξενιστή, στον υπολογιστή που εκτελείται το πρόγραμμα. Ο σκοπός του προγράμματος ξενιστή είναι να δημιουργήσει και να ζητήσει την πλατφόρμα και τις ιδιότητες της συσκευής, να ορίσει το περιεχόμενο, να κατασκευάσει τον πυρήνα, και να διαχειριστεί την εκτέλεση των πυρήνων. Όταν καταχωρηθεί ο πυρήνας απο τον ξενιστή στην συσκευή, δημιουργείται ένα Ν διαστάσεων χώρος ευρετηρίου, με το Ν να είναι από 1 έως 3. Κάθε περιστατικό πυρήνα δημιουργείται στις συντεταγμένες του χώρου ευρετηρίου. Αυτό το περιστατικό ονομάζεται αντικείμενο εργασίας και ο χώρος ευρετηρίου καλείται NDRange.\cite{opencl-4}  

\subsection{WebCL}
Με την δημοτικότητα των εφαρμογών web να αυξάνεται, υπάρχει ανάγκη για αύξηση της απόδοσης παράλληλης υπολογιστικής επεξεργασίας για να επιταχύνουμε τις διεργασίες εντατικού υπολογισμού σε εφαρμογές ιστού. Αυτές οι εφαρμογές περιλαμβάνουν για παράδειγμα, παρουσίαση απεικόνισης δεδομένων, επεξεργασία εικόνας και βίντεο, παιχνίδια τριών διαστάσεων, υπολογιστική φωτογραφία, κρυπτογραφία. Παρέχοντας στους προγραμματιστές με ένα πρότυπο Javascript API και μια γλώσσα φορητού προγραμματισμού, το WebCL επιτρέπει παράλληλο υπολογισμό σε ετερογενή πολυ-πύρηνα συστήματα σε μια σωρεία συσκευών, συμπεριλαμβανομένου φορητών, σταθερών, και διακομιστών. 

Το WebCL 1.0 ορίζει ένα Javascript binding στο πρότυπο OpenCL για ετερογενή παράλληλο υπολογισμό, ενώ επιτρέπει σε εφαρμογές ιστού να εκμεταλλευτούν τις δυνατότητες της GPU και τον παράλληλο υπολογισμό πολυπύρηνων CPU, μέσα απο έναν Web Browser, ενεργοποιώντας σημαντική επιτάχυνση των εφαρμογών όπως επεξεργασία βίντεο και εικόνας, και ανώτερης εξομοίωσης φυσικής για παιχνίδια WebGL. Το WebCL έχει αναπτυχτεί σε στενή συνεργασία με την κοινότητα του web, και παρέχει την δυνατότητα να επεκταθούν οι δυνατότητες των HTML5 browsers ώστε να επιταχύνουν τις εφαρμογές υψηλών απαιτήσεων υπολογισμού και πλούσιου οπτικού υπολογισμού. Το WebCL έχει σχεδιαστεί και συντηρείται από το μη κερδοσκοπικό ίδρυμα Khronos Group. Οι ολοκληρωμένες προδιαγραφές της πρώτης έκδοσης του WebCL ανακοινώθηκαν τον Μάρτιο του 2014.\cite{opencl-5} 

Ανάλογα την υλοποίηση, Το WebCL επιτρέπει στις διεργασίες να εκτελούνται ταυτόχρονα με την Javascript. Συγκεκριμένα, είναι δυνατόν για την εφαρμογή να επεξεργαστεί ένα buffer καθώς αντιγράφεται από ένα αντικείμενο WebCLMemoryObject. Για να αποτρέψουμε την φθορά των δεδομένων, οι εφαρμογές θα πρέπει να μην επεξεργάζονται τα buffers που έχουν σημαδευτεί για ασύγχρονη ανάγνωση/εγγραφή, έως ότου η σχετική ουρά εντολών WebCL έχει τελειώσει την εκτέλεση της.

\begin{figure}[h]
	\includegraphics[scale=1]{webcl-logo}
	\centering
	\caption{Λογότυπο WebCL}
\end{figure}
\begin{itemize}
\item Khronos Launching new WebCL initiative
	\begin{itemize}
	\item Ανακοινώθηκε τον Μάρτιο του 2011
	\item API definitions already underway
	\end{itemize}
\item Javascript binding για OpenCL
	\begin{itemize}
	\item Η ασφάλεια πρώτη προτεραιότητα
	\end{itemize}
\item Πολλές περιπτώσεις χρήσης
	\begin{itemize}
	\item Μηχανές φυσικής για συμπλήρωση του WebGL
	\item Επεξεργασία εικόνας και βίντεο σε browser
	\end{itemize}
\item Πολύ στενή σχέση με το πρότυπο OpenCL
	\begin{itemize}
	\item Maximum flexibility
	\item Foundation for higher-level middleware
	\end{itemize}
\end{itemize}


\subsubsection{Υλοποιήσεις}
Αυτήν την στιγμή, μόνο μια δοκιμαστική έκδοση του Chromium browser υποστηρίζει το WebCL, γιατί η τεχνολογία είναι σχετικά καινούρια. Όμως το webCL μπορεί να εκτελεστεί και ως ένα πρόσθετο. Για παράδειγμα, η Nokia έχει δημιουργήσει ένα πρόσθετο WebCL για τον Mozilla Firefox. Η Mozilla έχει ανακοινώσει ότι δεν θα υποστηρίξει το WebCL, λόγω των Compute Shader του OpenGL ES 3.1. Σαν παράδειγμα αναφέρουμε υλοποιήσεις που προσπαθούν να ακολουθήσουν τις προδιαγραφές WebCL 1.0
\begin{itemize}
\item Samsung (WebKit) - https://github.com/SRA-SiliconValley/webkit-webcl
\item Nokia (Firefox) - http://webcl.nokiaresearch.com/
\item Motorola Mobility node-webcl (node.js) - https://github.com/Motorola-Mobility/node-webcl
\end{itemize}


\subsubsection{Ασφάλεια}
Το WebCL έχει δημιουργηθεί δίνοντας μεγάλη έμφαση στην ασφάλεια. Μερικά από τα φαινόμενα που μπορεί να προκύψουν κατά την μεταγλώττιση ή και την εκτέλεση ενός πυρήνα WebCL είναι τα παρακάτω
\begin{itemize}
\item Πρόσβαση OOB(Out of Bounds) - Οι πυρήνες του WebCL πρέπει να μην επιτρέπουν πρόσβαση σε κρίσιμα μέρη της μνήμης, χωρίς να γίνονται διακρίσεις ανάλογα με τον τύπο της μεταβλητής.(private, global, constant). Αν ανιχνευθεί την ώρα της μεταγλώττισης, η πρόσβαση OOB πρέπει να παράγει ένα λάθος μεταγλώττισης. Την ώρα της εκτέλεσης, η προσπέλαση OOB πρέπει να επιστρέψει μηδέν, και οι εγγραφές να αγνοηθούν. Για λόγους ελέγχου του ορίου, η υλοποίηση μπορεί να μεταχειρίζεται τις μεταβλητές σαν ένα συνεχόμενο block μνήμης. Για τον έλεγχο των προσπελάσεων OOB, το Khronos Group ανέπτυξε τον WebCL Validator, ο οποίος αναγκάζει την αρχικοποίηση τοπικής μνήμης.
\item Αρχικοποίηση μνήμης - Για να σιγουρέψουμε ότι οι εφαρμογές δεν μπορούν να προσπελάσουν παλαιότερα δεδομένα που έχουν μείνει στην μνήμη απο προηγούμενες εφαρμογές, η υλοποίηση WebCL πρέπει να αρχικοποιεί όλα τα buffers και μεταβλητές στο μηδέν πριν επιτρέψει την πρόσβαση στην εφαρμογή μας. Αυτή η ανάγκη υπάρχει ανεξάρτητα από τον τύπο της μεταβλητής και ανεξάρτητα την συσκευή στην οποία εκτελείται ο κώδικας. Όπου είναι δυνατόν, το πρόσθετο OpenCL 1.2 "cl{\_}khr{\_}initialize{\_}memory" επιτρέπει στις υλοποιήσεις WebCL να αρχικοποιήσουν την τοπική μνήμη αυτόματα πριν την εκτέλεση ενός πυρήνα.
\item Άρνηση υπηρεσίας - Πυρήνες που εκτελούνται για μεγάλο χρονικό διάστημα ή πυρήνες εντατικών υπολογισμών (ή άλλες εντολές στην ουρά εντολών) μπορεί να προκαλέσουν αστάθεια στο σύστημα λόγω της υπερκατανάλωσης πόρων. Δεν είναι εύκολο να γίνει έλεγχος του συγκεκριμένου προβλήματος στο επίπεδο του WebCL. Οι απαραίτητοι μηχανισμοί, όπως μετρητές watchdog και προληπτικός πολυ-νηματικός προγραμματισμός, πρέπει να παρέχονται από τον οδηγό OpenCL και το λειτουργικό σύστημα. Σε συστήματα όπου οι παραπάνω μηχανισμοί είναι διαθέσιμοι, οι υλοποιήσεις WebCL πρέπει να τους χρησιμοποιούν για να:
	\begin{enumerate}
		\item Ανιχνεύουν προβληματικούς πυρήνες και άλλες εντολές. Μια εντολή θεωρείται προβληματική όταν εκτελείται για πολύ μεγάλο χρονικό διάστημα, ή καταναλώνει υπερβολικά πολλούς πόρους συστήματος
		\item Τερματίζει τα περιεχόμενα που σχετίζονται με τις προβληματικές εντολές, πριν αυτές καταστήσουν την συσκευή OpenCL απαθής, και την αναγκάσουν να χρειαστεί επανεκκίνηση.
	\end{enumerate}
\end{itemize}
Όπου αυτό είναι δυνατόν, το πρόσθετο OpenCL 1.2 "cl{\_}kh{\_}-terminate{\_}context" μπορεί να χρησιμοποιηθεί για γρήγορο τερματισμό ενός περιεχομένου, αν για παράδειγμα κάποιος πυρήνας εκτελείται για πολύ μεγάλο χρονικό διάστημα ή ένα από τα προγράμματα τερματιστεί λόγω εξαιρέσεων.
